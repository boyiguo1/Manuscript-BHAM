\section{Metabolomics Data Analysis}
\label{sec:real_data}

In this section, we apply the proposed model BHAM to analyze two published metabolomics datasets where the outcomes are binary and continuous respectively. We demonstrate the improved prediction performance compared to the other Bayesian hierarchical additive model, SB-GAM [@Bai2021], while being computationally efficient (see Table \ref{tab:time_real_data}). BHAM requires roughly 10\% of the computation time of SB-GAM to fit models.

\subsection{Emory Cardiovascular Biobank}
\label{sec:ECB}
We use the proposed model BHAM to analyze a metabolic dataset from a recently published research [@Mehta2020] studying plasma metabolomic profile on the three-year all-cause mortality among patients undergoing cardiac catheterization. The dataset is publicly available via \textit{Dryad} [@Mehta2020_data]. It contains in total of 776 subjects from two cohorts. As there is a large number of non-overlapping features among the two cohorts, we use the cohort with a larger sample size (N=454). There are initially 6796 features in the dataset, which is too large to be practically meaningful to analyze. Hence, we choose the top 200 features with the largest variance. We use 5-knot spline additive models for binary outcome using two different models, the proposed BHAM and the SB-GAM. 10-Fold CV are used to choose the optimal tuning parameters of each framework with respect to the default selection criterion implemented in the software. Out-of-bag samples are used for prediction performance evaluation, where deviance, AUC, Brier score, defined as $\frac{1}{n}\sum\limits^{n}_{i=1}(y_i - \hat y_i)^2$, and misclassification error, defined as $\frac{1}{n}\sum\limits^{n}_{i=1}I(|y_i - \hat y_i|>0.5)$ are calculated. BHAM obtains superior AUC, Brier score, and misclassification error in the out-of-bag samples compared to SB-GAM (see Table \ref{tab:ECB_res}). We plot the 33 features included in the final BHAM model in Figure \ref{fig:ECB_fig}.

\subsection{Weight Loss Maintenance Cohort}
We use the proposed model BHAM to analyze metabolomics data from a recently published study [@Bihlmeyer2021] on the association between metabolic biomarkers and weight loss, where the dataset is publicly available [@Bihlmeyer2021_data]. In this analysis, we primarily focus on the analysis of one of the three studies included, weight loss maintenance cohort [@Svetkey2008], due to the drastically different intervention effects. In the dataset, 765 metabolites in baseline plasma collected were profiled using liquid chromatography mass spectrometry. Quality control and natural log transformation were previously performed and documented by the study publishing team \cite{Bihlmeyer2021}. The outcome of interest is standardized percent change in insulin resistance, and hence modeled using a Gaussian model. After removing missing datapoints and addressing outliers in the data, there are $p$=`r nrow(WLM_train_dat)` features remaining in the analysis. 5-Knot spline additive models for the Gaussian outcome are constructed using two different models, the proposed BHAM and the SB-GAM. 10-Fold CV are used to choose the optimal tuning parameters of each framework with respect to the default selection criterion implemented in the software. Out-of-bag samples are used for prediction performance evaluation, where deviance, $R^2$, mean squared error (MSE) defined as $\frac{1}{n}\sum\limits^{n}_{i=1}(y_i - \hat y_i)^2$, and mean absolute error (MAE) defined as $\frac{1}{n}\sum\limits^{n}_{i=1}|y_i - \hat y_i|$ are calculated. BHAM obtains superior $R^2$, MSE, and MAE in the out-of-bag samples compared to SB-GAM (see Table \ref{tab:WLM_res}).
