\documentclass[AMA,STIX1COL,]{WileyNJD-v2}


% For Pandoc highlighting needs

% Pandoc citation processing

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pdflscape}
\usepackage{color}
\usepackage{soul}

\articletype{Research article}

\received{2021-01-01}

\revised{2021-02-01}

\accepted{2021-03-01}

\raggedbottom

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\begin{document}

\title{Spike-and-Slab Generalized Additive Models and Scalable
Algorithms for High-Dimensional Data}

\author[a]{Boyi Guo*}
\author[b]{Byron C. Jaeger}
\author[a]{AKM Fazlur Rahman}
\author[a]{D. Leann Long}
\author[a]{Nengjun Yi*}

\authormark{Guo et al.}

\address[a]{Department of Biostatistics, University of Alabama at
Birmingham, Birmingham, USA}
\address[b]{Department of Biostatistics and Data Science, Wake Forest
School of Medicine, Winston-Salem, USA}

\corres{Boyi Guo and Nengjun Yi, Department of Biostatistics, University
of Alabama at Birmingham, Birmingham, USA. \email{boyiguo1@uab.edu},
\email{nyi@uab.edu}}

\presentaddress{This is sample for present address text this is sample
for present address text}

\abstract{There are proposals that extend the classical generalized
additive models (GAMs) to accommodate high-dimensional data (\(p>>n\))
using group sparse regularization. However, the sparse regularization
may induce excess shrinkage when estimating smoothing functions,
damaging predictive performance. Moreover, most of these GAMs consider
an ``all-in-all-out'' approach for functional selection, rendering them
difficult to answer if nonlinear effects are necessary. While some
Bayesian models can address these shortcomings, using Markov chain Monte
Carlo algorithms for model fitting creates a new challenge, scalability.
Hence, we propose Bayesian hierarchical generalized additive models as a
solution: we consider the smoothing penalty for proper shrinkage of
curve interpolation and separation of smoothing function linear and
nonlinear spaces. A novel spike-and-slab spline prior is proposed to
select components of smoothing functions. Two scalable and deterministic
algorithms, EM-Coordinate Descent and EM-Iterative Weighted Least
Squares, are developed for different utilities. Simulation studies and
metabolomics data analyses demonstrate improved predictive or
computational performance against state-of-the-art models, mgcv, COSSO
and sparse Bayesian GAM. The software implementation of the proposed
models is freely available via an R package BHAM.}

\keywords{Spike-and-Slab Priors; High-Dimensional Data; Generalized
Additive Models; EM-IWLS; EM-Coordinate Decent; Scalablility}

\maketitle

\pgfplotsset{compat=1.18}
\usetikzlibrary{shapes.geometric, arrows, positioning, calc, matrix, backgrounds, fit}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\tp}{*}
\newcommand{\pr}{\text{Pr}}
\newcommand{\repa}{\text{repa}}
\newcommand{\simiid}{\overset{\text{iid}}{\sim}}
\newcommand{\bg}[1]{\textcolor{red}{#1}}

\clearpage

\bibliography{bibfile.bib}

\clearpage

\begin{figure}
\centering
\begin{tikzpicture} [
staticCompo/.style = {rectangle, minimum width=1cm, minimum height=1cm,text centered, draw=black, fill=blue!30},
outCome/.style={ellipse, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=blue!30},
mymatrix/.style={matrix of nodes, nodes=outCome, row sep=1em},
PriorBoarder/.style={rectangle, minimum width=5cm, minimum height=10cm, text centered, fill=lightgray!30},
background/.style={rectangle, fill=gray!10,inner sep=0.2cm, rounded corners=5mm}
]

\matrix (linearPrior) [matrix of nodes, column sep = 0mm, row sep = 0.7cm] {
  \node (linearGamma) [outCome] { $\gamma_j \sim Bin(1, \theta_j) $ };\\
  \node (linearBeta) [outCome] { $\beta_j \sim DE(0,(1-\gamma_{j}) s_0 + \gamma_{j} s_1)$};\\
};
\matrix (penPrior) [right = 2cm of linearPrior, matrix of nodes, column sep = 0mm, row sep = 0.7cm] {
  \node (penGamma) [outCome] { $\gamma_{j}^*\sim Bin(1, \textcolor{red}{\gamma_{j}}\theta_j)$ };\\
  \node (penBeta) [outCome] { $\beta_{jk}^*\sim  DE(0,(1-\gamma^*_{j}) s_0 + \gamma^*_{j} s_1)$};\\
};


\node (s) [staticCompo]  at ($(linearBeta)!0.5!(penBeta)$)  {($s_0, s_1$)};
\node (Beta) [staticCompo, below = 1cm of s] {$\boldsymbol{\beta }= (\beta_1, \boldsymbol{\beta}^*_1, \dots,\beta_j, \boldsymbol{\beta}^*_j , \dots,\beta_p, \boldsymbol{\beta}^*_p) $};
\node (Theta)[outCome, above = 2cm of s] {$\theta_{j} \sim Beta(a, b)$};
\node (ab)[staticCompo, above = 0.5cm of Theta] {$(a, b)$};
\node (Y) [outCome, below = 1cm of Beta] {$y_i \sim Expo. Fam. (g^{-1}(\boldsymbol{\beta}^T \boldsymbol{X}_i), \phi)$};

\draw[->] (Theta) -- (linearGamma);
\draw[->] (Theta) -- (penGamma);
\draw[->] (linearGamma) -- (linearBeta) ;
\draw[->] (penGamma) -- (penBeta);
\draw[->, draw = red] (linearGamma) -- (penGamma);
\draw[->] (ab) -- (Theta);
\draw[->] (s) -- (linearBeta) ;
\draw[->] (s) -- (penBeta);
\draw[->] (linearBeta) -- (Beta);
\draw[->] (penBeta) -- (Beta);
\draw[->] (Beta) --  (Y);


\begin{pgfonlayer}{background}
  \node [background,
   fit=(linearGamma) (linearBeta),
   label=above:Linear Space:] {};
  \node [background,
    fit=(penGamma) (penBeta),
    label=above:Nonlinear Space:] {};
\end{pgfonlayer}

\end{tikzpicture}

\caption{Directed acyclic graph of the proposed Bayesian hierarchical additive model with parameter expansion. Elliposes are stochastic nodes, rectangles and are deterministic nodes. }
\label{fig:SSprior}
\end{figure}

\include{"Tabs/sim_gaus_tab.tex"}
\include{Tabs/sim_binom_tab.tex}

\clearpage

\clearpage

\clearpage

\clearpage

\clearpage



\end{document}
